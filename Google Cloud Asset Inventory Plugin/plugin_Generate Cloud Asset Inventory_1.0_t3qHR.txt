{
  "referenceId": "t3qHR",
  "version": "1.0",
  "name": "Generate Cloud Asset Inventory",
  "license": "EULA",
  "description": null,
  "baseScript": "#! /bin/bash\nwget $key_json_url -O ./key.json\n\ngcloud auth activate-service-account $account_email --key-file=./key.json\nTOKEN=$(gcloud auth print-access-token)\n\ndt=$(date '+%Y-%m-%d-%s')\n\ncurl -H \"Authorization: Bearer $TOKEN\" -H \"Content-Type: application/json\" \\\n     -d \"{\\\"contentType\\\":\\\"RESOURCE\\\", \\\"outputConfig\\\":{\\\"gcsDestination\\\":{\\\"uri\\\":\\\"gs://$bucket_target/ca-$dt.json\\\"}}}\" \\\n        https://cloudasset.googleapis.com/v1beta1/projects/$project_id_number:exportAssets\n\ngcloud auth revoke $account_email\n\nrm ./key.json",
  "envs": [
    {
      "prop": "account_email",
      "val": "service_account@email.com",
      "hidden": false,
      "eval": null
    },
    {
      "prop": "project_id_number",
      "val": "1234356456",
      "hidden": false,
      "eval": null
    },
    {
      "prop": "bucket_target",
      "val": "bucket",
      "hidden": false,
      "eval": null
    },
    {
      "prop": "key_json_url",
      "val": "json_url",
      "hidden": false,
      "eval": null
    }
  ],
  "scriptArgs": null,
  "scriptLang": "SHELL",
  "timeout": 30
}